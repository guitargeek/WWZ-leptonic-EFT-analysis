# inspired by https://github.com/sgnoohc/VVVNanoLooper/blob/master/condor/datasets.py

_data_version = "02Apr2020"

data_2016 = {
    "data_Run2016Bv1_ee": f"/DoubleEG/Run2016B-{_data_version}_ver1-v1/NANOAOD",
    "data_Run2016Bv2_ee": f"/DoubleEG/Run2016B-{_data_version}_ver2-v1/NANOAOD",
    "data_Run2016C_ee": f"/DoubleEG/Run2016C-{_data_version}-v1/NANOAOD",
    "data_Run2016D_ee": f"/DoubleEG/Run2016D-{_data_version}-v1/NANOAOD",
    "data_Run2016E_ee": f"/DoubleEG/Run2016E-{_data_version}-v1/NANOAOD",
    "data_Run2016F_ee": f"/DoubleEG/Run2016F-{_data_version}-v1/NANOAOD",
    "data_Run2016G_ee": f"/DoubleEG/Run2016G-{_data_version}-v1/NANOAOD",
    "data_Run2016H_ee": f"/DoubleEG/Run2016H-{_data_version}-v1/NANOAOD",
    "data_Run2016Bv1_em": f"/MuonEG/Run2016B-{_data_version}_ver1-v1/NANOAOD",
    "data_Run2016Bv2_em": f"/MuonEG/Run2016B-{_data_version}_ver2-v1/NANOAOD",
    "data_Run2016C_em": f"/MuonEG/Run2016C-{_data_version}-v1/NANOAOD",
    "data_Run2016D_em": f"/MuonEG/Run2016D-{_data_version}-v1/NANOAOD",
    "data_Run2016E_em": f"/MuonEG/Run2016E-{_data_version}-v2/NANOAOD",
    "data_Run2016F_em": f"/MuonEG/Run2016F-{_data_version}-v1/NANOAOD",
    "data_Run2016G_em": f"/MuonEG/Run2016G-{_data_version}-v1/NANOAOD",
    "data_Run2016H_em": f"/MuonEG/Run2016H-{_data_version}-v1/NANOAOD",
    "data_Run2016Bv1_mm": f"/DoubleMuon/Run2016B-{_data_version}_ver1-v1/NANOAOD",
    "data_Run2016Bv2_mm": f"/DoubleMuon/Run2016B-{_data_version}_ver2-v1/NANOAOD",
    "data_Run2016C_mm": f"/DoubleMuon/Run2016C-{_data_version}-v1/NANOAOD",
    "data_Run2016D_mm": f"/DoubleMuon/Run2016D-{_data_version}-v1/NANOAOD",
    "data_Run2016E_mm": f"/DoubleMuon/Run2016E-{_data_version}-v1/NANOAOD",
    "data_Run2016F_mm": f"/DoubleMuon/Run2016F-{_data_version}-v1/NANOAOD",
    "data_Run2016G_mm": f"/DoubleMuon/Run2016G-{_data_version}-v1/NANOAOD",
    "data_Run2016H_mm": f"/DoubleMuon/Run2016H-{_data_version}-v1/NANOAOD",
}
data_2017 = {
    "data_Run2017B_ee": f"/DoubleEG/Run2017B-{_data_version}-v1/NANOAOD",
    "data_Run2017C_ee": f"/DoubleEG/Run2017C-{_data_version}-v1/NANOAOD",
    "data_Run2017D_ee": f"/DoubleEG/Run2017D-{_data_version}-v1/NANOAOD",
    "data_Run2017E_ee": f"/DoubleEG/Run2017E-{_data_version}-v1/NANOAOD",
    "data_Run2017F_ee": f"/DoubleEG/Run2017F-{_data_version}-v1/NANOAOD",
    "data_Run2017B_em": f"/MuonEG/Run2017B-{_data_version}-v1/NANOAOD",
    "data_Run2017C_em": f"/MuonEG/Run2017C-{_data_version}-v1/NANOAOD",
    "data_Run2017D_em": f"/MuonEG/Run2017D-{_data_version}-v1/NANOAOD",
    "data_Run2017E_em": f"/MuonEG/Run2017E-{_data_version}-v1/NANOAOD",
    "data_Run2017F_em": f"/MuonEG/Run2017F-{_data_version}-v1/NANOAOD",
    "data_Run2017B_mm": f"/DoubleMuon/Run2017B-{_data_version}-v1/NANOAOD",
    "data_Run2017C_mm": f"/DoubleMuon/Run2017C-{_data_version}-v1/NANOAOD",
    "data_Run2017D_mm": f"/DoubleMuon/Run2017D-{_data_version}-v1/NANOAOD",
    "data_Run2017E_mm": f"/DoubleMuon/Run2017E-{_data_version}-v1/NANOAOD",
    "data_Run2017F_mm": f"/DoubleMuon/Run2017F-{_data_version}-v1/NANOAOD",
}

data_2018 = {
    "EGamma_2018A": f"/EGamma/Run2018A-{_data_version}-v1/NANOAOD",
    "EGamma_2018B": f"/EGamma/Run2018B-{_data_version}-v1/NANOAOD",
    "EGamma_2018C": f"/EGamma/Run2018C-{_data_version}-v1/NANOAOD",
    "EGamma_2018D": f"/EGamma/Run2018D-{_data_version}-v1/NANOAOD",
    "DoubleMuon_2018A": f"/DoubleMuon/Run2018A-{_data_version}-v1/NANOAOD",
    "DoubleMuon_2018B": f"/DoubleMuon/Run2018B-{_data_version}-v1/NANOAOD",
    "DoubleMuon_2018C": f"/DoubleMuon/Run2018C-{_data_version}-v1/NANOAOD",
    "DoubleMuon_2018D": f"/DoubleMuon/Run2018D-{_data_version}-v1/NANOAOD",
    "MuonEG_2018A": f"/MuonEG/Run2018A-{_data_version}-v1/NANOAOD",
    "MuonEG_2018B": f"/MuonEG/Run2018B-{_data_version}-v1/NANOAOD",
    "MuonEG_2018C": f"/MuonEG/Run2018C-{_data_version}-v1/NANOAOD",
    "MuonEG_2018D": f"/MuonEG/Run2018D-{_data_version}-v1/NANOAOD",
}


_mc_2016_campaign = "RunIISummer16NanoAODv7-Nano02Apr2020_102X_mcRun2_asymptotic_v8"
# some datasets have PUMoriond17 in the GT, I don't know what the difference is
_mc_2016_campaign_pumoriond = "RunIISummer16NanoAODv7-PUMoriond17_Nano02Apr2020_102X_mcRun2_asymptotic_v8"


mc_2016 = {
    # Signals
    "WWW_2l": f"/WWW_4F_DiLeptonFilter_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "WWW_incl": f"/WWW_4F_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "WWZ_incl": f"/WWZ_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "WZZ_incl": f"/WZZ_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "ZZZ_incl": f"/ZZZ_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "VHtoNonBB": f"/VHToNonbb_M125_13TeV_amcatnloFXFX_madspin_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    # Backgrounds
    ## ZZ
    "ZZcontTo2e2mu": f"/GluGluToContinToZZTo2e2mu_13TeV_MCFM701_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "ZZcontTo2e2tau": f"/GluGluToContinToZZTo2e2tau_13TeV_MCFM701_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "ZZcontTo2mu2tau": f"/GluGluToContinToZZTo2mu2tau_13TeV_MCFM701_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "ZZcontTo4e": f"/GluGluToContinToZZTo4e_13TeV_MCFM701_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "ZZcontTo4mu": f"/GluGluToContinToZZTo4mu_13TeV_MCFM701_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "ZZcontTo4tau": f"/GluGluToContinToZZTo4tau_13TeV_MCFM701_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "ZZ": f"/ZZTo4L_13TeV_powheg_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    ## TTZ
    "TTZnlo_ext1": f"/TTZToLLNuNu_M-10_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    "TTZnlo_ext2": f"/TTZToLLNuNu_M-10_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}_ext2-v1/NANOAODSIM",
    "TTZnlo_ext3": f"/TTZToLLNuNu_M-10_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}_ext3-v1/NANOAODSIM",
    "TTZLOW": f"/TTZToLL_M-1to10_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/{_mc_2016_campaign}-v1/NANOAODSIM",
    ## WZ
    "WZ": f"/WZTo3LNu_TuneCUETP8M1_13TeV-powheg-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    ## TWZ
    "TWZ": f"/ST_tWll_5f_LO_13TeV-MadGraph-pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    ## X + gamma
    "WZG": f"/WZG_TuneCUETP8M1_13TeV-amcatnlo-pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    ## DY/ttbar
    "DY_low": f"/DYJetsToLL_M-10to50_TuneCUETP8M1_13TeV-amcatnloFXFX-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    "DY_high": f"/DYJetsToLL_M-50_TuneCUETP8M1_13TeV-amcatnloFXFX-pythia8/{_mc_2016_campaign_pumoriond}_ext2-v1/NANOAODSIM",
    "TTDL": f"/TTJets_DiLept_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    "TTSLtop": f"/TTJets_SingleLeptFromT_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    "TTSLtopbar": f"/TTJets_SingleLeptFromTbar_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    ## Others
    "GGHtoZZto4L": f"/GluGluHToZZTo4L_M125_13TeV_powheg2_JHUgenV6_pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    "TTHtoNonBB": f"/ttHToNonbb_M125_TuneCUETP8M2_ttHtranche3_13TeV-powheg-pythia8/{_mc_2016_campaign_pumoriond}-v1/NANOAODSIM",
    ## TT + X
    "TTWnlo": f"/TTWJetsToLNu_TuneCUETP8M1_13TeV-amcatnloFXFX-madspin-pythia8/{_mc_2016_campaign_pumoriond}_ext2-v1/NANOAODSIM",
    ## TT + XX
    "TTWW": f"/TTWW_TuneCUETP8M2T4_13TeV-madgraph-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    "TTWZ": f"/TTWZ_TuneCUETP8M2T4_13TeV-madgraph-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    "TTZH": f"/TTZH_TuneCUETP8M2T4_13TeV-madgraph-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    "TTZZ": f"/TTZZ_TuneCUETP8M2T4_13TeV-madgraph-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
    "TTWH": f"/TTWH_TuneCUETP8M2T4_13TeV-madgraph-pythia8/{_mc_2016_campaign_pumoriond}_ext1-v1/NANOAODSIM",
}

_mc_2017_campaign = "RunIIFall17NanoAODv7-PU2017_12Apr2018_Nano02Apr2020_102X_mc2017_realistic_v8"
# no idea what this EXT in the global tag means, but come datasets have it
_mc_2017_campaign_ext = "RunIIFall17NanoAODv7-PU2017_12Apr2018_Nano02Apr2020_EXT_102X_mc2017_realistic_v8"
# I also don't know what this "new_pmx" should mean
_mc_2017_campaign_new_pmx = "RunIIFall17NanoAODv7-PU2017_12Apr2018_Nano02Apr2020_new_pmx_102X_mc2017_realistic_v8"
_mc_2017_campaign_recosimstep = (
    "RunIIFall17NanoAODv7-PU2017RECOSIMstep_12Apr2018_Nano02Apr2020_102X_mc2017_realistic_v8"
)


mc_2017 = {
    # Signals
    "WWW_2l": f"/WWW_4F_DiLeptonFilter_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "WWW_incl": f"/WWW_4F_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "WWW_incl_ext": f"/WWW_4F_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign_ext}-v1/NANOAODSIM",
    "WWZ_4l": f"/WWZJetsTo4L2Nu_4f_TuneCP5_13TeV_amcatnloFXFX_pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "WWZ_incl": f"/WWZ_4F_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "WWZ_incl_ext": f"/WWZ_4F_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign_ext}-v1/NANOAODSIM",
    "WZZ_4l": f"/WZZJetsTo4L2Nu_4f_TuneCP5_13TeV_amcatnloFXFX_pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "WZZ_incl": f"/WZZ_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "WZZ_incl_ext": f"/WZZ_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign_ext}-v1/NANOAODSIM",
    "ZZZ_4l": f"/ZZZJetsTo4L2Nu_4f_TuneCP5_13TeV_amcatnloFXFX_pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "ZZZ_incl": f"/ZZZ_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "ZZZ_incl_ext": f"/ZZZ_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign_ext}-v1/NANOAODSIM",
    "VHtoNonBB": f"/VHToNonbb_M125_13TeV_amcatnloFXFX_madspin_pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    # Backgrounds
    ## ZZ
    "ZZcontTo2e2mu": f"/GluGluToContinToZZTo2e2mu_13TeV_MCFM701_pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "ZZcontTo2e2tau": f"/GluGluToContinToZZTo2e2tau_13TeV_MCFM701_pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "ZZcontTo2mu2tau": f"/GluGluToContinToZZTo2mu2tau_13TeV_MCFM701_pythia8/{_mc_2017_campaign}_ext1-v1/NANOAODSIM",
    "ZZcontTo4e": f"/GluGluToContinToZZTo4e_13TeV_MCFM701_pythia8/{_mc_2017_campaign_ext}-v1/NANOAODSIM",
    "ZZcontTo4mu": f"/GluGluToContinToZZTo4mu_13TeV_MCFM701_pythia8/{_mc_2017_campaign}_ext1-v1/NANOAODSIM",
    "ZZcontTo4tau": f"/GluGluToContinToZZTo4tau_13TeV_MCFM701_pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "ZZ": f"/ZZTo4L_13TeV_powheg_pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "ZZ_ext1": f"/ZZTo4L_13TeV_powheg_pythia8/{_mc_2017_campaign}_ext1-v1/NANOAODSIM",
    "ZZ_ext2": f"/ZZTo4L_13TeV_powheg_pythia8/{_mc_2017_campaign}_ext2-v1/NANOAODSIM",
    "ZZ_new_pmx": f"/ZZTo4L_13TeV_powheg_pythia8/{_mc_2017_campaign_new_pmx}-v1/NANOAODSIM",  # new_pmx
    ## TTZ
    "TTZnlo": f"/TTZToLLNuNu_M-10_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "TTZnlo_ext": f"/TTZToLLNuNu_M-10_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign_ext}-v1/NANOAODSIM",  # ext
    "TTZnloPSweights": f"/TTZToLLNuNu_M-10_TuneCP5_PSweights_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "TTZLOW": f"/TTZToLL_M-1to10_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    "TTZLOW_ext": f"/TTZToLL_M-1to10_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign_ext}-v1/NANOAODSIM",  # ext
    ## WZ
    "WZ": f"/WZTo3LNu_TuneCP5_13TeV-amcatnloFXFX-pythia8/{_mc_2017_campaign_new_pmx}-v1/NANOAODSIM",
    ## TWZ
    "TWZ": f"/ST_tWll_5f_LO_TuneCP5_PSweights_13TeV-madgraph-pythia8/{_mc_2017_campaign}_ext1-v1/NANOAODSIM",
    ## X + gamma
    "WZG": f"/WZG_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    ## DY/ttbar
    "DY_low": f"/DYJetsToLL_M-10to50_TuneCP5_13TeV-madgraphMLM-pythia8/{_mc_2017_campaign}_ext1-v1/NANOAODSIM",
    "DY_high": f"/DYJetsToLL_M-50_TuneCP5_13TeV-madgraphMLM-pythia8/{_mc_2017_campaign_recosimstep}-v1/NANOAODSIM",
    "TTDL": f"/TTTo2L2Nu_TuneCP5_13TeV-powheg-pythia8/{_mc_2017_campaign_new_pmx}-v1/NANOAODSIM",
    "TTSL": f"/TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8/{_mc_2017_campaign}_ext1-v1/NANOAODSIM",
    ## Others
    "GGHtoZZto4L": f"/GluGluHToZZTo4L_M125_13TeV_powheg2_JHUGenV7011_pythia8/{_mc_2017_campaign}_ext3-v1/NANOAODSIM",
    "TTHtoNonBB": f"/ttHToNonbb_M125_TuneCP5_13TeV-powheg-pythia8/{_mc_2017_campaign_new_pmx}-v1/NANOAODSIM",
    ## TT + X
    "TTWnlo": f"/TTWJetsToLNu_TuneCP5_13TeV-amcatnloFXFX-madspin-pythia8/{_mc_2017_campaign}-v1/NANOAODSIM",
    ## TT + XX
    "TTWW": f"/TTWW_TuneCP5_13TeV-madgraph-pythia8/{_mc_2017_campaign_new_pmx}_ext1-v1/NANOAODSIM",
    "TTWZ": f"/TTWZ_TuneCP5_13TeV-madgraph-pythia8/{_mc_2017_campaign_new_pmx}-v1/NANOAODSIM",
    "TTZH": f"/TTZH_TuneCP5_13TeV-madgraph-pythia8/{_mc_2017_campaign_new_pmx}-v1/NANOAODSIM",
    "TTZZ": f"/TTZZ_TuneCP5_13TeV-madgraph-pythia8/{_mc_2017_campaign_new_pmx}-v1/NANOAODSIM",
    "TTWH": f"/TTWH_TuneCP5_13TeV-madgraph-pythia8/{_mc_2017_campaign_new_pmx}-v1/NANOAODSIM",
}

_mc_2018_campaign = "RunIIAutumn18NanoAODv7-Nano02Apr2020_102X_upgrade2018_realistic_v21"
_mc_2018_campaign_ext = "RunIIAutumn18NanoAODv7-Nano02Apr2020_EXT_102X_upgrade2018_realistic_v21"

mc_2018 = {
    # Signals
    "WWW_2l": f"/WWW_4F_DiLeptonFilter_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "WWW_incl": f"/WWW_4F_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "WWZ_4l": f"/WWZJetsTo4L2Nu_4f_TuneCP5_13TeV_amcatnloFXFX_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "WWZ_incl": f"/WWZ_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "WZZ_4l": f"/WZZJetsTo4L2Nu_4f_TuneCP5_13TeV_amcatnloFXFX_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "WZZ_incl": f"/WZZ_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "ZZZ_4l": f"/ZZZJetsTo4L2Nu_4f_TuneCP5_13TeV_amcatnloFXFX_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "ZZZ_incl": f"/ZZZ_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "VHtoNonBB": f"/VHToNonbb_M125_13TeV_amcatnloFXFX_madspin_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    # Backgrounds
    ## ZZ
    "ZZcontTo2e2mu": f"/GluGluToContinToZZTo2e2mu_13TeV_MCFM701_pythia8/RunIIAutumn18NanoAODv6-Nano25Oct2019_ext1_102X_upgrade2018_realistic_v20-v1/NANOAODSIM",
    "ZZcontTo2e2tau": f"/GluGluToContinToZZTo2e2tau_13TeV_MCFM701_pythia8/RunIIAutumn18NanoAODv6-Nano25Oct2019_ext1_102X_upgrade2018_realistic_v20-v1/NANOAODSIM",
    "ZZcontTo2mu2tau": f"/GluGluToContinToZZTo2mu2tau_13TeV_MCFM701_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "ZZcontTo4e": f"/GluGluToContinToZZTo4e_13TeV_MCFM701_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "ZZcontTo4e_ext1": f"/GluGluToContinToZZTo4e_13TeV_MCFM701_pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "ZZcontTo4mu": f"/GluGluToContinToZZTo4mu_13TeV_MCFM701_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "ZZcontTo4mu_ext1": f"/GluGluToContinToZZTo4mu_13TeV_MCFM701_pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "ZZcontTo4tau": f"/GluGluToContinToZZTo4tau_13TeV_MCFM701_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "ZZcontTo4tau_ext": f"/GluGluToContinToZZTo4tau_13TeV_MCFM701_pythia8/{_mc_2018_campaign_ext}-v1/NANOAODSIM",
    "ZZ_ext1": f"/ZZTo4L_TuneCP5_13TeV_powheg_pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "ZZ_ext2": f"/ZZTo4L_TuneCP5_13TeV_powheg_pythia8/{_mc_2018_campaign}_ext2-v1/NANOAODSIM",
    ## TTZ
    "TTZnlo": f"/TTZToLLNuNu_M-10_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "TTZLOW": f"/TTZToLL_M-1to10_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    # WZ
    "WZ": f"/WZTo3LNu_TuneCP5_13TeV-amcatnloFXFX-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    # TWZ
    "TWZ": f"/ST_tWll_5f_LO_TuneCP5_PSweights_13TeV-madgraph-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    # X + gamma
    "WZG": f"/WZG_TuneCP5_13TeV-amcatnlo-pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "WZG": f"/WZG_TuneCP5_13TeV-amcatnlo-pythia8/RunIIFall17NanoAODv6-PU2017_12Apr2018_Nano25Oct2019_102X_mc2017_realistic_v7-v1/NANOAODSIM",
    # DY/ttbar
    "DY_low": f"/DYJetsToLL_M-10to50_TuneCP5_13TeV-madgraphMLM-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "DY_high": f"/DYJetsToLL_M-50_TuneCP5_13TeV-madgraphMLM-pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "DYzpt150": f"/DYJetsToLL_M-50_Zpt-150toInf_TuneCP5_13TeV-madgraphMLM-pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "TTDL": f"/TTTo2L2Nu_TuneCP5_13TeV-powheg-pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "TTSL": f"/TTToSemiLeptonic_TuneCP5_13TeV-powheg-pythia8/{_mc_2018_campaign}_ext3-v1/NANOAODSIM",
    # Others
    "GGHtoZZto4L": f"/GluGluHToZZTo4L_M125_13TeV_powheg2_JHUGenV7011_pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    "TTHtoNonBB": f"/ttHToNonbb_M125_TuneCP5_13TeV-powheg-pythia8/{_mc_2018_campaign}-v1/NANOAODSIM",
    # TT + X
    "TTWnlo": f"/TTWJetsToLNu_TuneCP5_13TeV-amcatnloFXFX-madspin-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    # TT + XX
    "TTWW": f"/TTWW_TuneCP5_13TeV-madgraph-pythia8/{_mc_2018_campaign}_ext2-v1/NANOAODSIM",
    "TTWZ": f"/TTWZ_TuneCP5_13TeV-madgraph-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "TTZZ": f"/TTZZ_TuneCP5_13TeV-madgraph-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "TTWH": f"/TTWH_TuneCP5_13TeV-madgraph-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
    "TTZH": f"/TTZH_TuneCP5_13TeV-madgraph-pythia8/{_mc_2018_campaign}_ext1-v1/NANOAODSIM",
}


def _add_datasets(all_datasets, datasets_to_add, prefix):
    for key, value in datasets_to_add.items():
        all_datasets[prefix + key] = value


all_datasets = dict()
# _add_datasets(all_datasets, mc_2016, "mc_2016_")
# _add_datasets(all_datasets, mc_2017, "mc_2017_")
_add_datasets(all_datasets, mc_2018, "mc_2018_")
# _add_datasets(all_datasets, data_2016, "data_2016_")
# _add_datasets(all_datasets, data_2017, "data_2017_")
# _add_datasets(all_datasets, data_2018, "data_2018_")


def get_file_list(dataset):
    file_list = os.popen('dasgoclient -query="file dataset={0}"'.format(dataset)).read()
    file_list = [f.strip() for f in file_list.split("\n") if ".root" in f]
    return file_list


import os
from collections import namedtuple


def get_scratch_path(dataset):
    base_path = "/scratch"
    first_file = get_file_list(dataset)[0]

    # check if the path is like expected
    int(first_file.split("/")[-2])

    return "/scratch" + os.path.join(base_path, "/".join(first_file.split("/")[:-2]))


def get_datasets(year, mc=True):
    if mc:
        if year == 2016:
            return mc_2016
        if year == 2017:
            return mc_2017
        if year == 2018:
            return mc_2018
    else:
        if year == 2016:
            return data_2016
        if year == 2017:
            return data_2017
        if year == 2018:
            return data_2018


DatasetInfo = namedtuple("DatasetInfo", ["short_name", "das_name", "year", "mc", "scratch_path", "skim_path"])


def get_skim_path(short_name, year, mc):
    return os.path.join("/scratch/skims", "mc" if mc else "data", str(year), short_name)


def get_dataset_infos(year, mc=True):

    infos = []

    datasets = get_datasets(year, mc)

    for short_name, das_name in datasets.items():
        infos.append(
            DatasetInfo(
                short_name=short_name,
                das_name=das_name,
                year=year,
                mc=mc,
                scratch_path=get_scratch_path(das_name),
                skim_path=get_skim_path(short_name, year, mc),
            )
        )

    return infos


if __name__ == "__main__":

    import argparse

    parser = argparse.ArgumentParser(description="Print out the list of datasets for a given year.")
    parser.add_argument("year", type=int)
    parser.add_argument("--mc", action="store_true")
    parser.add_argument("--path", action="store_true")

    args = parser.parse_args()

    # just print all the datasets
    def print_datasets(datasets):
        for name, dataset in datasets.items():
            if args.path:
                print(get_scratch_path(dataset))
            else:
                print(dataset)

    datasets = get_datasets(year, mc)
    print_datasets(datasets)
